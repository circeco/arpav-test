<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="description" content="ARPAV test page">
	<meta name="keywords" content="ARPAV test page">
	<meta name="author" content="ICS Piero Grilli">

	<title>ARPAV test</title>

	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

	<!-- Bootstrap Table CSS -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.18.3/bootstrap-table.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.18.3/dist/extensions/filter-control/bootstrap-table-filter-control.css" rel="stylesheet">

	<!-- Popper.js -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.10.2/umd/popper.min.js"></script>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

	<!-- jQuery -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

	<!-- Bootstrap Table Scripts -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.18.3/bootstrap-table.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.18.3/dist/extensions/filter-control/bootstrap-table-filter-control.js"></script>

	<!-- Bootstrap Table Export and dependencies -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.js"></script>
	<script src="https://rawgit.com/hhurz/tableExport.jquery.plugin/master/tableExport.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.18.3/extensions/export/bootstrap-table-export.min.js"></script>

</head>

<body style="overflow-x: hidden">
	<h1 style="text-align: center; padding: 20px">ARPAV test site</h1>
	<div id="table-container" style="margin: auto 20px">

		<table id="table" 
			data-toggle="table" 
			data-height="600" 
			data-search="true" 
			data-filter-control="true"
			data-show-export="true" 
			data-click-to-select="true" 
			data-export-data-type="selected">

			<thead>
				<tr>
					<th data-field="cartellino" data-sortable="true"></th>
					<th data-field="errore" data-filter-control="select" data-sortable="true">Errore</th>
					<th data-field="sensid" data-filter-control="input" data-sortable="true">Sensore ID</th>
					<th data-field="codice" data-filter-control="input" data-sortable="true">Codice</th>
					<th data-field="statid" data-filter-control="input" data-sortable="true">Station ID</th>
					<th data-field="subnetwork" data-filter-control="select" data-sortable="true">Subnetwork</th>
					<th data-field="codice_SIRAV" data-filter-control="input" data-sortable="true">Codice_SIRAV</th>
					<th data-field="type" data-filter-control="select" data-sortable="true">Type</th>
					<th data-field="descr" data-filter-control="select" data-sortable="true">Descrizione</th>
					<th data-field="nome_breve_sensore" data-filter-control="select" data-sortable="true">Nome breve sensore</th>
					<th data-field="codice_sensore" data-filter-control="input" data-sortable="true">Codice sensore</th>
					<th data-field="nome" data-filter-control="input" data-sortable="true">Nome</th>
					<th data-field="inizio" data-filter-control="select" data-sortable="true">Inizio</th>
					<th data-field="fine" data-filter-control="select" data-sortable="true">Fine</th>
					<th data-field="quota" data-filter-control="input" data-sortable="true">Quota</th>
					<th data-field="comune" data-filter-control="select" data-sortable="true">Comune</th>
					<th data-field="provincia" data-filter-control="select" data-sortable="true">Provincia</th>
					<th data-field="acronimo" data-filter-control="select" data-sortable="true">Acronimo</th>
					<th data-field="nome_stazione" data-filter-control="input" data-sortable="true">Nome stazione</th>
					<th data-field="epsg3003_X" data-filter-control="input" data-sortable="true">Epsg3003_X</th>
					<th data-field="epsg3003_Y" data-filter-control="input" data-sortable="true">Epsg3003_Y</th>
					<th data-field="epsg4258_Lat" data-filter-control="input" data-sortable="true">Epsg4258_Lat</th>
					<th data-field="epsg4258_Lon" data-filter-control="input" data-sortable="true">Epsg4258_Lon</th>
					<th data-field="state" data-checkbox="true"></th>
				</tr>
			</thead>

			<tbody></tbody>

			<!-- <tbody>
				<tr>
					<td><svg height="20" width="20"><circle cx="10" cy="10" r="10" fill="#ff0000"/></svg></td>
					<td class="bs-checkbox "><input data-index="0" name="btSelectItem" type="checkbox"></td>
				</tr>
				<tr>
					<td><svg height="20" width="20"><circle cx="10" cy="10" r="10" fill="#f47801"/></svg></td>
					<td class="bs-checkbox "><input data-index="1" name="btSelectItem" type="checkbox"></td>
				</tr>
				<tr>
					<td><svg height="20" width="20"><circle cx="10" cy="10" r="10" fill="#01f460"/></svg></td>
					<td class="bs-checkbox "><input data-index="2" name="btSelectItem" type="checkbox"></td>
				</tr>
				<tr>
					<td><svg height="20" width="20"><circle cx="10" cy="10" r="10" fill="#f4db01"/></svg></td>
					<td class="bs-checkbox "><input data-index="3" name="btSelectItem" type="checkbox"></td>
				</tr>
			</tbody> -->


		</table>
	</div>

	<script type="module">
		import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";

		// Select the HTML element where you want to place the table
		const table = d3.select("#table-container").select("table");

		const columns = [
			"cartellino", "errore", "sensid", "codice", "statid", "subnetwork", "codice_SIRAV",
			"type", "descr", "nome_breve_sensore", "codice_sensore", "nome", "inizio", "fine", "quota",
			"comune", "provincia", "acronimo", "nome_stazione", "epsg3003_X", "epsg3003_Y",
			"epsg4258_Lat", "epsg4258_Lon", "state"
		];

		// Create a table body
		const tbody = table.select("tbody");

		// Load the CSV file
		function convert(d) {
			return {
				cartellino: d.cartellino,
				errore: d.errore,
				sensid: d.sensid,
				codice: d.codice,
				statid: d.statid,
				subnetwork: d.subnetwork,
				codice_SIRAV: d.codice_SIRAV,
				type: d.type,
				descr: d.descr,
				nome_breve_sensore: d.nome_breve_sensore,
				codice_sensore: d.codice_sensore,
				nome: d.nome,
				inizio: d.inizio,
				fine: d.fine,
				quota: d.quota,
				comune: d.comune,
				provincia: d.provincia,
				acronimo: d.acronimo,
				nome_stazione: d.nome_stazione,
				epsg3003_X: d.epsg3003_X,
				epsg3003_Y: d.epsg3003_Y,
				epsg4258_Lat: d.epsg4258_Lat,
				epsg4258_Lon: d.epsg4258_Lon,
				state: d.state
			}
		}
		const data = await d3.dsv(";", "SIRAV_anagrafica_stazioni_sensori.csv", convert);

		console.log("This is data: ", data)
		// Data loading is complete, now you can use the data
		const rows = tbody.selectAll("tr")
			.data(data)
			.enter().append("tr");

		// Create cells for each row
		rows.selectAll("td")
			.data(row => columns.map(column => ({ column: column, value: row[column] })))
			.enter().append("td")
			.text(d => d.value);


		$(document).ready(function () {
			var $table = $('#table');
			// Initialize the Bootstrap Table
			$table.bootstrapTable();
			// You can add more customization or handle events here if needed
		});
	</script>
</body>

</html>